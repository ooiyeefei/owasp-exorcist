# Requirements Document

## Introduction

The Dynamic Vulnerability Generator transforms The Digital Exorcism from a fixed-puzzle game into an infinite security training simulator. By leveraging the OWASP MCP server and Kiro's code generation capabilities, the system will dynamically generate vulnerable React components at game start, providing unique challenges each playthrough while teaching real-world security concepts.

## Glossary

- **DVG (Dynamic Vulnerability Generator)**: The system that generates vulnerable code components at runtime
- **OWASP MCP**: Model Context Protocol server that provides access to OWASP vulnerability data and patterns
- **Vulnerability Template**: A code pattern structure that can be populated with specific vulnerability implementations
- **Game Session**: A single playthrough from game start to completion (0% corruption)
- **Difficulty Mode**: User-selected challenge level (Easy or Hard) that affects hint visibility and complexity
- **Corruption State**: JSON file tracking active vulnerabilities and corruption percentage
- **Component Injection**: The process of generating and writing vulnerable component files to disk

## Requirements

### Requirement 1

**User Story:** As a player, I want each game session to present different vulnerabilities, so that I can practice security skills with varied challenges and improve my learning.

#### Acceptance Criteria

1. WHEN a player starts a new game session THEN the system SHALL generate a unique set of vulnerable components different from previous sessions
2. WHEN the system generates vulnerabilities THEN it SHALL select from at least 5 different OWASP vulnerability types
3. WHEN a player completes a game and starts again THEN the system SHALL present different vulnerability patterns than the previous session
4. WHEN vulnerabilities are generated THEN the system SHALL ensure no two consecutive game sessions have identical vulnerability combinations
5. WHEN the game generates components THEN each component SHALL contain realistic, production-like code patterns that demonstrate the vulnerability

### Requirement 2

**User Story:** As a player, I want the system to use real OWASP vulnerability data, so that I learn industry-standard security concepts and terminology.

#### Acceptance Criteria

1. WHEN the system generates vulnerabilities THEN it SHALL fetch current vulnerability details from the OWASP MCP server
2. WHEN displaying vulnerability information THEN the system SHALL include the official OWASP classification and description
3. WHEN a vulnerability is fixed THEN the system SHALL provide educational content from OWASP documentation
4. WHEN the system selects vulnerabilities THEN it SHALL prioritize vulnerabilities from the current OWASP Top 10 list
5. WHEN OWASP data is unavailable THEN the system SHALL fall back to cached vulnerability patterns and notify the user

### Requirement 3

**User Story:** As a player, I want generated vulnerabilities to feel realistic and contextual, so that I learn how these issues appear in real codebases.

#### Acceptance Criteria

1. WHEN the system generates a vulnerable component THEN it SHALL include realistic variable names, function names, and business logic context
2. WHEN creating vulnerability patterns THEN the system SHALL embed them within functional React components that render properly
3. WHEN generating code THEN the system SHALL include appropriate imports, TypeScript types, and React hooks
4. WHEN a component is created THEN it SHALL integrate with the existing Dashboard component without requiring manual wiring
5. WHEN vulnerabilities are injected THEN the surrounding code SHALL follow the project's existing code style and conventions

### Requirement 4

**User Story:** As a player, I want difficulty modes to affect the complexity and obviousness of vulnerabilities, so that I can choose an appropriate challenge level.

#### Acceptance Criteria

1. WHEN a player selects Easy mode THEN the system SHALL generate vulnerabilities with obvious patterns and clear indicators
2. WHEN a player selects Hard mode THEN the system SHALL generate vulnerabilities with subtle patterns and obfuscated implementations
3. WHEN in Easy mode THEN the system SHALL include code comments that hint at the vulnerability location
4. WHEN in Hard mode THEN the system SHALL remove hints and use realistic variable names that don't indicate security issues
5. WHEN difficulty affects generation THEN the system SHALL adjust the complexity of surrounding code to match the selected difficulty

### Requirement 5

**User Story:** As a player, I want the game to track which vulnerabilities I've encountered, so that I can see my progress and learning history.

#### Acceptance Criteria

1. WHEN a game session starts THEN the system SHALL record which vulnerability types were generated
2. WHEN a player fixes a vulnerability THEN the system SHALL log the vulnerability type and timestamp
3. WHEN a player completes multiple sessions THEN the system SHALL maintain a history of encountered vulnerability types
4. WHEN displaying statistics THEN the system SHALL show which OWASP categories the player has practiced
5. WHEN selecting vulnerabilities for a new session THEN the system SHALL consider the player's history to provide varied learning experiences

### Requirement 6

**User Story:** As a developer extending the game, I want a clear template system for vulnerability patterns, so that I can easily add new vulnerability types.

#### Acceptance Criteria

1. WHEN adding a new vulnerability type THEN the developer SHALL define it using a standardized template structure
2. WHEN a template is defined THEN it SHALL specify the OWASP category, difficulty range, and code pattern
3. WHEN the system loads templates THEN it SHALL validate that each template contains required fields
4. WHEN templates are invalid THEN the system SHALL log errors and exclude them from generation
5. WHEN templates are updated THEN the system SHALL reload them without requiring application restart

### Requirement 7

**User Story:** As a player, I want generated components to automatically integrate with the game UI, so that I can immediately start playing without manual setup.

#### Acceptance Criteria

1. WHEN vulnerable components are generated THEN the system SHALL automatically register them with the Dashboard component
2. WHEN the game starts THEN the Dashboard SHALL display all generated vulnerable components without manual configuration
3. WHEN components are created THEN the system SHALL update the corruption state JSON file with vulnerability metadata
4. WHEN the corruption state updates THEN the UI SHALL reflect changes without requiring page refresh
5. WHEN a game session ends THEN the system SHALL clean up generated components and reset the Dashboard state

### Requirement 8

**User Story:** As a player, I want the system to generate between 3-5 vulnerabilities per session, so that games are completable in a reasonable timeframe while providing sufficient challenge.

#### Acceptance Criteria

1. WHEN a game session starts THEN the system SHALL generate between 3 and 5 vulnerable components
2. WHEN determining the number of vulnerabilities THEN the system SHALL consider the selected difficulty mode
3. WHEN in Easy mode THEN the system SHALL generate 3 vulnerabilities
4. WHEN in Hard mode THEN the system SHALL generate 4-5 vulnerabilities
5. WHEN generating multiple vulnerabilities THEN the system SHALL ensure they are distinct OWASP categories

### Requirement 9

**User Story:** As a player, I want Kiro to act as the vulnerability generator, so that I experience the AI's code generation capabilities as part of the game mechanics.

#### Acceptance Criteria

1. WHEN a game starts THEN Kiro SHALL receive a prompt to generate vulnerable components based on OWASP data
2. WHEN Kiro generates code THEN it SHALL use the OWASP MCP tools to fetch vulnerability details
3. WHEN creating components THEN Kiro SHALL write them to the src/components/vulnerable directory
4. WHEN generation is complete THEN Kiro SHALL update the corruption state and notify the player
5. WHEN generation fails THEN Kiro SHALL explain the issue and offer to retry with different parameters

### Requirement 10

**User Story:** As a player, I want the system to provide hints about generated vulnerabilities in Easy mode, so that I can learn security concepts even if I'm unfamiliar with them.

#### Acceptance Criteria

1. WHEN Easy mode is active THEN the Dashboard SHALL display vulnerability type hints for each component
2. WHEN a player hovers over a component in Easy mode THEN the system SHALL show the OWASP category
3. WHEN a player requests help THEN Kiro SHALL provide specific guidance about the vulnerability type
4. WHEN in Easy mode THEN generated components SHALL include TODO comments indicating the vulnerability location
5. WHEN hints are displayed THEN they SHALL be educational without revealing the exact fix

### Requirement 11

**User Story:** As a player learning cloud security, I want to see how AWS services can prevent or detect each vulnerability type, so that I understand practical security solutions in production environments.

#### Acceptance Criteria

1. WHEN a vulnerability is explained THEN the system SHALL include relevant AWS security service recommendations
2. WHEN displaying educational content THEN the system SHALL provide concise examples of which AWS services address the vulnerability
3. WHEN a player fixes a vulnerability THEN Kiro SHALL mention the AWS service that would prevent this issue in production
4. WHEN educational content is shown THEN it SHALL include at least one AWS service name and a brief explanation of how it helps
5. WHEN multiple AWS services are relevant THEN the system SHALL prioritize the most commonly used service for that vulnerability type

### Requirement 12

**User Story:** As a player, I want to learn about AWS security best practices alongside OWASP concepts, so that I can apply this knowledge to real-world cloud deployments.

#### Acceptance Criteria

1. WHEN the system generates vulnerability templates THEN each template SHALL include an AWS security services section
2. WHEN displaying vulnerability information THEN the system SHALL show both the OWASP classification and relevant AWS security services
3. WHEN a player completes a game session THEN the system SHALL provide a summary of AWS services that could have prevented the encountered vulnerabilities
4. WHEN educational content is provided THEN it SHALL explain how the AWS service specifically addresses the vulnerability pattern
5. WHEN showing AWS service recommendations THEN the system SHALL include links to AWS documentation for further learning
